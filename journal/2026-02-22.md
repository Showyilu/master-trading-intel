# 2026-02-22

Initial bootstrap complete.

- Repository initialized for long-term trading intelligence.
- Core plan and memory scaffolding created.
- Next step: load source inventory + first opportunity pipeline.

## Run @ 03:02 UTC

### 做了什么
- 新增数据源清单与字段映射：`sources/inventory.yaml`（CEX/DEX/链上/新闻）。
- 新增标准化机会 schema：`schemas/normalized_opportunity_v1.schema.json`。
- 新增机会评分与风控模板：`playbooks/opportunity-scoring-template.md`。
- 新增扫描脚本：`scripts/scan_opportunities.py`，自动计算
  `net_edge_bps = gross - fees - slippage - latency_risk - transfer_risk`。
- 生成机会看板与短名单：`opportunities/dashboard-latest.md`、`opportunities/shortlist-latest.json`。

### 结果
- 本轮样本共扫描 4 条候选，按风险门槛通过 1 条。
- 已验证：高 gross edge 在费用/滑点/延迟惩罚后可被过滤掉，避免误报。

### 阻塞点
- 当前输入仍是样本数据，尚未接入实时 API（Binance/Bybit/DEX quote）。
- 尚未引入深度簿和分笔成交，滑点估算仍是简化版本。

### 下一步
- 接入 Binance + Bybit 实时报价适配器并转成 normalized schema。
- 加入基础深度数据估算 size-aware slippage。
- 每轮扫描产出“可执行候选 + 失败原因”双列表。

## Run @ 03:05 UTC

### 做了什么
- 交付实时 CEX 数据接入脚本：`scripts/build_live_cex_candidates.py`（Binance + Bybit）。
- 新增标准化报价 schema：`schemas/normalized_quote_v1.schema.json`。
- 升级扫描器参数化：`scripts/scan_opportunities.py` 支持 `--input/--output-*`，可直接吃 live candidates。
- 产出实时文件：
  - `data/normalized_quotes_cex_latest.json`
  - `data/opportunity_candidates.live.json`
  - `opportunities/shortlist-latest.json`
  - `opportunities/dashboard-latest.md`

### 结果
- 本轮实时拉取并标准化 20 条报价（10 个 symbol × 2 个 CEX）。
- 生成 3 条正向 gross edge 候选，但在 `gross - fees - slippage - latency - transfer_risk` 后全部不达标（0/3 qualified）。
- 验证了系统能稳定给出“可执行候选为空 + 原因可解释”的输出，而不是硬凑信号。

### 阻塞点
- 当前仅 top-of-book，无深度簿/成交分布，滑点仍是保守启发式。
- DEX 侧尚未接入，策略覆盖仍偏窄（暂未覆盖 cex-dex / funding / cross-chain live）。

### 下一步
- 接 Binance/Bybit depth 估算 size-aware slippage（按目标下单金额分档）。
- 接入 1 个 DEX quote 源（优先 Jupiter 或 Uniswap）并统一到同一候选格式。
- 输出失败原因聚合（fee-dominated / latency-dominated / transfer-dominated）用于策略路由。

## Run @ 03:11 UTC

### 做了什么
- 新增 DEX 实时接入与 CEX-DEX 候选生成：`scripts/build_live_cex_dex_candidates.py`（Jupiter + Binance/Bybit）。
- 新增候选合并脚本：`scripts/merge_candidate_files.py`，将 CEX-CEX 与 CEX-DEX 候选统一评分。
- 更新源配置与文档：`sources/inventory.yaml`、`README.md`（新增 live CEX+DEX pipeline）。
- 加入关键风控护栏：DEX `reference_deviation_bps` 与 `crossed_quote` 过滤，拦截假价差（包装资产/异常路由）。
- 重新跑全链路，产出：
  - `data/normalized_quotes_dex_latest.json`
  - `data/opportunity_candidates.cex_dex.live.json`
  - `data/opportunity_candidates.combined.live.json`
  - `opportunities/shortlist-latest.json`
  - `opportunities/dashboard-latest.md`

### 结果
- DEX 标准化报价 2 条（SOL/BTC），其中 BTC 因参考价偏离过大被 guard 过滤（拒绝 1 条）。
- 合并后共评分 6 条候选，按净边际公式 `gross - fees - slippage - latency - transfer` 全部不达标（0 qualified）。
- 系统验证通过：可持续产出“无机会但原因可解释”的结果，避免假阳性。

### 阻塞点
- 仍是 top-of-book + quote 级别，未引入深度簿与下单金额分档，滑点模型仍偏启发式。
- DEX 目前仅 Jupiter；未覆盖 Uniswap/EVM DEX 与链上 gas 拥堵联动惩罚。

### 下一步
- 接 Binance/Bybit orderbook depth，做 size-aware slippage 曲线（按 1k/5k/10k USD 档位）。
- 增加失败原因聚合（fee/slippage/latency/transfer 主导）并写入 dashboard。
- 扩展第二个 DEX 源（Uniswap 或 0x）做交叉校验，降低单源偏差风险。

## Run @ 03:49 UTC

### 做了什么
- 按“别人怎么做套利并赚钱”做了专项研究，重点抽取可落地方法（funding carry / cross-exchange funding / CEX-CEX / CEX-DEX）。
- 新增研究沉淀文档：`research/how-others-find-arb-edge.md`。
- 将外部方法论转换为本项目执行要求：
  - 先净边际再谈机会（而非看 gross spread）
  - 强制 size-aware slippage + 执行可达性
  - 预置库存与风控优先于“追高毛利”

### 结果
- 明确了我们下一阶段主线：从“发现价差”切到“发现可执行净正机会”。
- 结论与当前系统表现一致（目前 0 qualified 并非坏事，说明过滤器在挡假机会）。

### 阻塞点
- 尚缺 funding-rate 实时接入和 depth 曲线，导致 carry 类机会无法稳定量化比较。

### 下一步
- 先补 funding-rate 适配器 + depth slippage 曲线，再更新看板成“执行优先”排序。

## Run @ 04:01 UTC

### 做了什么
- 升级扫描器 `scripts/scan_opportunities.py`：新增拒绝原因标签与主导摩擦项识别（fees/slippage/latency/transfer）。
- 新增结构化输出 `opportunities/rejection-summary-latest.json`，汇总每轮拒绝原因计数与 top rejected 明细。
- 更新看板 `opportunities/dashboard-latest.md`，新增 Rejection Breakdown 区块，直接显示“哪类摩擦最伤净边际”。
- 重跑 live CEX + DEX 全链路（Binance/Bybit/Jupiter -> merge -> score）。

### 结果
- 本轮 3 条候选，0 条通过；拒绝原因聚合显示：`fee_dominated=3`、`latency_transfer_dominated=3`、`slippage_dominated=2`。
- 主导摩擦项统计为 `fees=3`，说明当前首要矛盾是手续费结构而非信号发现不足。
- 交付物已可复现：运行扫描后同时产出 shortlist、dashboard、rejection summary 三份结果文件。

### 阻塞点
- 仍缺 size-aware depth 滑点模型，当前 slippage 以启发式参数估算，难以精细评估不同下单规模。
- funding-rate/basis 数据尚未接入，无法并行评估 carry 类机会池。

### 下一步
- 接入 Binance/Bybit orderbook depth，并按 1k/5k/10k USD 档位输出分层 slippage 曲线。
- 把 rejection summary 接入执行路由规则（例如 fee 主导时优先筛低费账户/预置库存路径）。

## Run @ 06:02 UTC

### 做了什么
- 交付 size-aware 深度滑点模型：重构 `scripts/build_live_cex_candidates.py`，新增 Binance/Bybit orderbook depth 拉取与分档滑点计算（1k/5k/10k USD）。
- 新增输出文件 `data/cex_depth_slippage_latest.json`，记录每个 symbol/venue 的 depth 层级与分档买卖滑点。
- CEX-CEX 候选生成改为优先使用 depth 滑点（无 depth 时才回退到 top-of-book 启发式），并把模型信息写入候选 notes。
- 新增 schema：`schemas/cex_depth_slippage_v1.schema.json`；更新 `README.md` 与运行说明。

### 结果
- 本轮实时构建：20 条 normalized quotes、20 个 depth model（10 symbol × 2 venue）、7 条合并候选（CEX+CEX-DEX）。
- 扫描结果 0/7 qualified；拒绝原因聚合：`fee_dominated=7`、`latency_transfer_dominated=7`、`slippage_dominated=6`。
- 验证点：滑点评估已从“点差近似”升级为“按下单金额分档的订单簿 VWAP 模型”，可复现且可追踪。

### 阻塞点
- 资金费率/funding 与 basis 机会池尚未接入，当前仍主要是 spot 跨场景，机会密度偏低。
- 手续费主导仍最突出，若不引入更低费账户层级或预置库存，净边际很难转正。

### 下一步
- 新增 funding-rate + perp/spot basis 适配器，扩展 carry 类候选池并复用当前净边际风控模板。
- 将 rejection summary 映射为路由动作（fee 主导 -> 优先低费路径；latency 主导 -> 优先同链/预置库存路径）。

## Run @ 08:03 UTC

### 做了什么
- 新增 funding/basis 实时适配器：`scripts/build_live_funding_candidates.py`（Binance Perp + Bybit Linear funding）。
- 新增标准化 funding schema：`schemas/normalized_funding_v1.schema.json`，并更新 `sources/inventory.yaml`（加入 perp funding 数据源）。
- 将 funding 候选接入全链路：更新 `scripts/build_for_web.py`、`.github/workflows/pages-dashboard.yml`、`README.md`，合并池新增 `data/opportunity_candidates.funding.live.json`。
- 重跑全流程并产出：`data/normalized_funding_latest.json`、`data/opportunity_candidates.funding.live.json`、`data/opportunity_candidates.combined.live.json`、`opportunities/rejection-summary-latest.json`。

### 结果
- 本轮 funding 标准化 20 条（10 symbol × 2 venue），生成 funding carry 候选 7 条；与 CEX/CEX-DEX 合并后总候选 13 条。
- 扫描后 0/13 qualified；拒绝聚合显示 `fee_dominated=13`、`latency_transfer_dominated=13`、`slippage_dominated=12`，主导摩擦仍是 fees。
- 验证点：carry 机会已进入统一净边际模板（`gross - fees - slippage - latency - transfer`），并可持续自动产出可复现结果。

### 阻塞点
- 当前 funding gross edge 普遍 <2bps，而 round-trip taker fee + slippage 约 27.4bps，净边际天然为负。
- 缺少 perp-spot basis（同场对冲）与 maker/低费账户参数，导致 carry 桶暂时只起“过滤器”作用。

### 下一步
- 接入 perp-spot basis 适配器（Binance/Bybit mark vs spot mid）并建“预置库存 + maker 费率”分支模型。
- 在 scanner 增加 execution profile（taker/maker、VIP 费率、预置库存开关）做情景化净边际对比。
