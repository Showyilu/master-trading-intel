# 2026-02-23

## Run @ 00:04 UTC

### 做了什么
- 交付 **B类可验证产出（机会评分与风控模板增强）**：在约束模型中新增 `max_leverage`，并贯通到以下模块：
  - `schemas/execution_constraints_v1.schema.json`
  - `scripts/build_execution_constraints_template.py`
  - `scripts/build_authenticated_constraints.py`
  - `scripts/scan_opportunities.py`
- 扫描器新增杠杆硬门槛：当 `required leverage > max_leverage` 时，直接标记 `leverage_limit_exceeded` 并拒绝候选。
- 看板与拒绝摘要新增杠杆可见性（`max_leverage` / `leverage_used`），保证每轮扫描可审计。
- 重跑产线：
  - `build_execution_constraints_template.py`
  - `build_authenticated_constraints.py`
  - `scan_opportunities.py`（`taker_default` + `maker_inventory`）

### 结果
- 约束文件已更新：`data/execution_constraints.latest.json`（21 条规则全部带 `max_leverage`）。
- 本轮扫描（30 candidates）结果：
  - `taker_default`: 0 qualified，新增拒绝计数 `leverage_limit_exceeded=13`
  - `maker_inventory`: 0 qualified，新增拒绝计数 `leverage_limit_exceeded=13`
- 验证通过：`python3 -m py_compile` 对改动脚本编译成功，产物稳定输出（shortlist/dashboard/rejection summary）。

### 阻塞点
- Bybit 借币额度/借币利率仍未接入鉴权覆盖，`max_borrow_usd` 与 `borrow_rate_bps_per_hour` 在 Bybit 侧仍主要依赖模板。
- 当前环境缺少 Binance/Bybit 鉴权变量，authenticated overlay 仍走 fail-soft（不报错但不覆盖实值）。

### 下一步
- 优先接 Bybit signed margin endpoints（借币额度 + 利率 + 可用杠杆层级）并回填 constraints。
- 在 scanner 增加“按策略类型定制杠杆口径”（spot-hedge / basis / funding 分别定义 required leverage）以降低误判。
- 完成后再做一次端到端跑数，确认 `leverage_limit_exceeded` 与 borrow 约束联动一致。
